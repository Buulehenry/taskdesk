{# TaskDesk UI Macros — Progress Bars Usage: {% from 'macros.html' import progress_bar, task_status_progress, progress_cell %} {{ progress_bar(62, text='62% complete') }} {{ progress_bar(35, text='Uploading…', size='sm') }} {{ task_status_progress(task.status)
}} #} {%- macro progress_bar(percent=0, text=None, size='md', striped=True, animated=True, color=None) -%} {# Clamp percent safely #} {% set p = percent|float %} {% if p
< 0 %}{% set p=0 %}{% elif p> 100 %}{% set p = 100 %}{% endif %} {% set size_class_map = {'sm':'progress-sm','md':'','lg':'progress-lg'} %} {% set size_class = size_class_map[size] if size in size_class_map else '' %} {% set bar_classes = 'progress-bar' %} {% if striped %}{% set bar_classes
    = bar_classes + ' progress-bar-striped' %}{% endif %} {% if animated %}{% set bar_classes = bar_classes + ' progress-bar-animated' %}{% endif %} {% if color %}{% set bar_classes = bar_classes + ' bg-' + color %}{% endif %}

    <div class="progress {{ size_class }}" role="progressbar" aria-valuenow="{{ p|round(0) }}" aria-valuemin="0" aria-valuemax="100" aria-label="{{ text or (p|round(0)|string + '%') }}">
        <div class="{{ bar_classes }}" style="width: {{ '%.2f'|format(p) }}%">
            <span class="small fw-semibold">{{ text or (p|round(0)|string + '%') }}</span>
        </div>
    </div>
    {%- endmacro -%} {# Map task status → % + label + color #} {%- macro task_status_progress(status) -%} {% set s = (status or '')|lower|replace('-', '_') %} {% set label = 'Started' %} {% set pct = 5 %} {% set color = 'secondary' %} {% if s in ['submitted']
    %} {% set label = 'Submitted' %} {% set pct = 10 %} {% set color = 'secondary' %} {% elif s in ['quoted', 'pending_accept'] %} {% set label = 'Quoted' %} {% set pct = 25 %} {% set color = 'warning' %} {% elif s in ['in_progress'] %} {% set label =
    'In progress' %} {% set pct = 55 %} {% set color = 'primary' %} {% elif s in ['review_scheduled', 'review'] %} {% set label = 'Review scheduled' %} {% set pct = 75 %} {% set color = 'info' %} {% elif s in ['awaiting_payment'] %} {% set label = 'Awaiting
    payment' %} {% set pct = 85 %} {% set color = 'warning' %} {% elif s in ['delivered', 'closed'] %} {% set label = 'Completed' %} {% set pct = 100 %} {% set color = 'success' %} {% elif s in ['canceled', 'cancelled'] %} {% set label = 'Cancelled' %}
    {% set pct = 100 %} {% set color = 'dark' %} {% endif %} {{ progress_bar(pct, text=label ~ ' • ' ~ pct ~ '%', color=color) }} {%- endmacro -%} {# Compact cell helper for tables #} {%- macro progress_cell(status) -%}
    <div style="min-width:160px">{{ task_status_progress(status) }}</div>
    {%- endmacro -%}